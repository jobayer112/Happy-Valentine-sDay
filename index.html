<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Valentine 2026 - Love Competition</title>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    
    <style>
        :root {
            --primary-color: #e91e63;
            --primary-dark: #c2185b;
            --primary-light: #f8bbd0;
            --secondary-color: #9c27b0;
            --accent-color: #ff4081;
            --text-dark: #333333;
            --text-light: #666666;
            --bg-light: #fce4ec;
            --bg-white: #ffffff;
            --success-color: #4caf50;
            --danger-color: #f44336;
            --warning-color: #ff9800;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --shadow-hover: 0 6px 20px rgba(0, 0, 0, 0.12);
            --radius: 12px;
            --radius-sm: 8px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Hind Siliguri', 'Poppins', sans-serif;
            background-color: var(--bg-light);
            color: var(--text-dark);
            line-height: 1.5;
            font-size: 14px;
            padding: 10px;
            -webkit-tap-highlight-color: transparent;
            transition: background 0.3s;
        }

        body.english {
            font-family: 'Poppins', 'Hind Siliguri', sans-serif;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            background: var(--bg-white);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            transition: all 0.3s;
        }

        /* Language Switcher */
        .language-switcher {
            position: fixed;
            top: 15px;
            right: 15px;
            z-index: 1000;
        }

        .lang-btn {
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid var(--primary-color);
            border-radius: 50px;
            padding: 8px 15px;
            font-weight: 600;
            color: var(--primary-color);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: var(--shadow);
            transition: all 0.3s;
        }

        .lang-btn:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
        }

        /* Header Styles */
        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="rgba(255,255,255,0.1)" d="M30,30 Q50,10 70,30 T90,30 T70,50 T90,70 T70,90 T50,70 T30,90 T10,70 T30,50 T10,30 T30,30 Z"/></svg>');
            background-size: 80px;
            opacity: 0.3;
        }

        .header-content {
            position: relative;
            z-index: 1;
        }

        .logo {
            font-size: 2.5rem;
            margin-bottom: 10px;
            animation: heartbeat 1.5s infinite;
        }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        h1 {
            font-size: 1.8rem;
            margin-bottom: 5px;
            font-weight: 700;
        }

        .subtitle {
            font-size: 1rem;
            opacity: 0.9;
            margin-bottom: 15px;
        }

        /* Prize Section */
        .prize-section {
            padding: 20px;
            background: linear-gradient(135deg, #ffeb3b, #ff9800);
            color: #333;
            text-align: center;
            margin: 15px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        .prize-title {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 15px;
            color: #d32f2f;
        }

        .prize-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .prize-item {
            background: rgba(255, 255, 255, 0.9);
            padding: 12px;
            border-radius: var(--radius-sm);
            font-weight: 600;
        }

        .prize-amount {
            font-size: 1.3rem;
            color: var(--primary-color);
            font-weight: 700;
        }

        /* Auth Forms */
        .auth-container {
            padding: 20px;
        }

        .form-section {
            background: white;
            margin-bottom: 20px;
            padding: 20px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            display: none;
        }

        .form-section.active {
            display: block;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-title {
            color: var(--primary-color);
            font-size: 1.3rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary-light);
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-dark);
        }

        .input-field {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: var(--radius-sm);
            font-family: inherit;
            font-size: 1rem;
            transition: all 0.3s;
            background: #fafafa;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary-color);
            background: white;
            box-shadow: 0 0 0 3px rgba(233, 30, 99, 0.1);
        }

        .select-field {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: var(--radius-sm);
            font-family: inherit;
            font-size: 1rem;
            background: #fafafa;
        }

        /* Button Styles */
        .btn {
            padding: 14px 20px;
            border: none;
            border-radius: var(--radius-sm);
            font-family: inherit;
            font-size: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(233, 30, 99, 0.3);
        }

        .btn-secondary {
            background: #f5f5f5;
            color: var(--text-dark);
            border: 1px solid #ddd;
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9rem;
            width: auto;
        }

        /* Toggle Switch */
        .toggle-switch {
            display: flex;
            background: #f0f0f0;
            border-radius: var(--radius-sm);
            padding: 4px;
            margin-bottom: 20px;
        }

        .toggle-btn {
            flex: 1;
            padding: 12px;
            text-align: center;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .toggle-btn.active {
            background: var(--primary-color);
            color: white;
        }

        /* Dashboard */
        .dashboard {
            display: none;
            padding: 20px;
        }

        .user-info-card {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            border-radius: var(--radius);
            margin-bottom: 20px;
            box-shadow: var(--shadow);
        }

        .user-name {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .user-type {
            display: inline-block;
            padding: 4px 12px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50px;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: white;
            border-radius: var(--radius-sm);
            padding: 16px;
            box-shadow: var(--shadow);
            text-align: center;
            border: 1px solid #f0f0f0;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--text-light);
        }

        /* Referral Section */
        .referral-section {
            background: white;
            padding: 20px;
            border-radius: var(--radius);
            margin-bottom: 20px;
            box-shadow: var(--shadow);
        }

        .referral-link-box {
            background: #f8f9fa;
            border: 2px dashed #ddd;
            border-radius: var(--radius-sm);
            padding: 15px;
            margin: 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .referral-link {
            flex: 1;
            font-family: monospace;
            font-size: 0.9rem;
            color: var(--primary-color);
            word-break: break-all;
            padding: 10px;
            background: white;
            border-radius: var(--radius-sm);
            border: 1px solid #eee;
        }

        .copy-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 100px;
            justify-content: center;
        }

        .copy-btn:hover {
            background: var(--primary-dark);
        }

        .copy-btn.copied {
            background: var(--success-color);
        }

        .referral-message {
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 12px;
            border-radius: var(--radius-sm);
            margin-top: 15px;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        /* Tasks Section */
        .tasks-section {
            background: white;
            padding: 20px;
            border-radius: var(--radius);
            margin-bottom: 20px;
            box-shadow: var(--shadow);
        }

        .task-filters {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            overflow-x: auto;
            padding-bottom: 10px;
        }

        .filter-btn {
            padding: 8px 16px;
            background: #f5f5f5;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-weight: 500;
            white-space: nowrap;
        }

        .filter-btn.active {
            background: var(--primary-color);
            color: white;
        }

        .task-item {
            background: #f9f9f9;
            border-radius: var(--radius-sm);
            padding: 16px;
            margin-bottom: 12px;
            border-left: 4px solid var(--primary-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .task-info h4 {
            margin-bottom: 5px;
            color: var(--text-dark);
        }

        .task-status {
            font-size: 0.85rem;
            color: var(--text-light);
        }

        .task-completed {
            color: var(--success-color);
            font-weight: 600;
        }

        .task-btn {
            padding: 8px 16px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-weight: 500;
            min-width: 120px;
            text-align: center;
        }

        .task-btn.completed {
            background: var(--success-color);
            cursor: default;
        }

        .task-btn.disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .task-btn.available {
            background: var(--primary-color);
        }

        .task-btn.pending {
            background: var(--warning-color);
        }

        /* Timer Display */
        .timer-display {
            text-align: center;
            padding: 15px;
            background: linear-gradient(135deg, #2196f3, #1976d2);
            color: white;
            border-radius: var(--radius);
            margin: 15px 0;
            display: none;
        }

        .timer-text {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
            font-family: monospace;
        }

        /* Leaderboard */
        .leaderboard-section {
            background: white;
            padding: 20px;
            border-radius: var(--radius);
            margin-bottom: 20px;
            box-shadow: var(--shadow);
        }

        .leaderboard-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid #eee;
            transition: background 0.3s;
        }

        .leaderboard-item:hover {
            background: #f9f9f9;
        }

        .leaderboard-rank {
            width: 30px;
            height: 30px;
            background: var(--primary-light);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: var(--primary-color);
            margin-right: 12px;
        }

        .leaderboard-rank.top-3 {
            background: linear-gradient(135deg, #ffd700, #ff9800);
            color: white;
        }

        .leaderboard-user {
            flex: 1;
        }

        .leaderboard-points {
            font-weight: 700;
            color: var(--primary-color);
        }

        /* Payment Form */
        .payment-section {
            background: white;
            padding: 20px;
            border-radius: var(--radius);
            margin-bottom: 20px;
            box-shadow: var(--shadow);
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 20px 15px;
            color: var(--text-light);
            font-size: 0.8rem;
            border-top: 1px solid #f0f0f0;
            margin-top: 20px;
        }

        /* Rules Modal */
        .rules-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .rules-content {
            background: white;
            border-radius: var(--radius);
            padding: 25px;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .rules-list {
            margin: 15px 0;
            padding-left: 20px;
        }

        .rules-list li {
            margin-bottom: 10px;
        }

        /* Progress Bar */
        .progress-container {
            margin: 20px 0;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 0.9rem;
            color: var(--text-dark);
        }

        .progress-bar {
            height: 10px;
            background: #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 5px;
            transition: width 0.5s ease;
        }

        /* Responsive */
        @media (min-width: 768px) {
            .container {
                max-width: 800px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 15px;
            }
            
            .prize-list {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .referral-link-box {
                flex-direction: row;
            }
        }

        @media (min-width: 1024px) {
            .container {
                max-width: 1000px;
            }
        }

        /* Animation for new users */
        @keyframes celebrate {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .celebrate {
            animation: celebrate 0.5s ease 3;
        }

        /* Task Counter */
        .task-counter {
            background: var(--primary-color);
            color: white;
            padding: 5px 10px;
            border-radius: var(--radius-sm);
            font-weight: 600;
            display: inline-block;
        }

        /* Notification */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--success-color);
            color: white;
            padding: 12px 20px;
            border-radius: var(--radius);
            box-shadow: var(--shadow-hover);
            display: none;
            align-items: center;
            gap: 10px;
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Loading Spinner */
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--primary-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>

<!-- Language Switcher -->
<div class="language-switcher">
    <button class="lang-btn" id="languageToggle">
        <i class="fas fa-language"></i>
        <span id="currentLang">à¦¬à¦¾à¦‚à¦²à¦¾</span>
    </button>
</div>

<!-- Rules Modal -->
<div class="rules-modal" id="rulesModal">
    <div class="rules-content">
        <h2 style="color: var(--primary-color); margin-bottom: 15px;">
            <i class="fas fa-info-circle"></i> <span class="lang-text" data-en="Contest Rules" data-bn="à¦ªà§à¦°à¦¤à¦¿à¦¯à§‹à¦—à¦¿à¦¤à¦¾à¦° à¦¨à¦¿à¦¯à¦¼à¦®à¦¾à¦¬à¦²à§€"></span>
        </h2>
        <ul class="rules-list">
            <li class="lang-text" data-en="Contest Period: February 1 - February 14, 2026" data-bn="à¦ªà§à¦°à¦¤à¦¿à¦¯à§‹à¦—à¦¿à¦¤à¦¾à¦° à¦¸à¦®à¦¯à¦¼à¦•à¦¾à¦²: à§§à¦²à¦¾ à¦«à§‡à¦¬à§à¦°à§à¦¯à¦¼à¦¾à¦°à¦¿ - à§§à§ªà¦‡ à¦«à§‡à¦¬à§à¦°à§à¦¯à¦¼à¦¾à¦°à¦¿ à§¨à§¦à§¨à§¬"></li>
            <li class="lang-text" data-en="Maximum 60 tasks can be completed daily (20 tasks Ã— 3 rounds)" data-bn="à¦ªà§à¦°à¦¤à¦¿à¦¦à¦¿à¦¨ à¦¸à¦°à§à¦¬à§‹à¦šà§à¦š à§¬à§¦à¦Ÿà¦¿ à¦Ÿà¦¾à¦¸à§à¦• à¦¸à¦®à§à¦ªà¦¨à§à¦¨ à¦•à¦°à¦¾ à¦¯à¦¾à¦¬à§‡ (à§¨à§¦ à¦Ÿà¦¾à¦¸à§à¦• Ã— à§© à¦°à¦¾à¦‰à¦¨à§à¦¡)"></li>
            <li class="lang-text" data-en="Total 20 tasks must be completed to qualify for the competition" data-bn="à¦®à§‹à¦Ÿ à§¨à§¦à¦Ÿà¦¿ à¦Ÿà¦¾à¦¸à§à¦• à¦¸à¦®à§à¦ªà¦¨à§à¦¨ à¦•à¦°à¦¤à§‡ à¦¹à¦¬à§‡ à¦ªà§à¦°à¦¤à¦¿à¦¯à§‹à¦—à¦¿à¦¤à¦¾à¦¯à¦¼ à¦…à¦‚à¦¶à¦—à§à¦°à¦¹à¦£à§‡à¦° à¦œà¦¨à§à¦¯"></li>
            <li class="lang-text" data-en="Each person must invite at least 30 friends" data-bn="à¦ªà§à¦°à¦¤à§à¦¯à§‡à¦•à¦•à§‡ à¦•à¦®à¦ªà¦•à§à¦·à§‡ à§©à§¦ à¦œà¦¨ à¦¬à¦¨à§à¦§à§à¦•à§‡ à¦†à¦®à¦¨à§à¦¤à§à¦°à¦£ à¦œà¦¾à¦¨à¦¾à¦¤à§‡ à¦¹à¦¬à§‡"></li>
            <li class="lang-text" data-en="For couples: Both names must be mentioned during registration" data-bn="à¦•à¦¾à¦ªà¦² à¦¹à¦²à§‡ à¦…à¦¬à¦¶à§à¦¯à¦‡ à¦‰à¦­à¦¯à¦¼à§‡à¦° à¦¨à¦¾à¦® à¦°à§‡à¦œà¦¿à¦¸à§à¦Ÿà§à¦°à§‡à¦¶à¦¨à§‡ à¦‰à¦²à§à¦²à§‡à¦– à¦•à¦°à¦¤à§‡ à¦¹à¦¬à§‡"></li>
            <li class="lang-text" data-en="For couples: Must share with 20 other couples" data-bn="à¦•à¦¾à¦ªà¦²à¦¦à§‡à¦° à¦œà¦¨à§à¦¯: à§¨à§¦à¦Ÿà¦¿ à¦•à¦¾à¦ªà¦²à¦¦à§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦¶à§‡à¦¯à¦¼à¦¾à¦° à¦•à¦°à¦¤à§‡ à¦¹à¦¬à§‡"></li>
            <li class="lang-text" data-en="Prize distribution: February 15, 2026" data-bn="à¦ªà§à¦°à¦¸à§à¦•à¦¾à¦° à¦¬à¦¿à¦¤à¦°à¦£: à§§à§«à¦‡ à¦«à§‡à¦¬à§à¦°à§à¦¯à¦¼à¦¾à¦°à¦¿ à§¨à§¦à§¨à§¬"></li>
            <li class="lang-text" data-en="Contest results are final and non-appealable" data-bn="à¦ªà§à¦°à¦¤à¦¿à¦¯à§‹à¦—à¦¿à¦¤à¦¾à¦° à¦«à¦²à¦¾à¦«à¦² à¦šà§‚à¦¡à¦¼à¦¾à¦¨à§à¦¤ à¦à¦¬à¦‚ à¦†à¦¬à§‡à¦¦à¦¨à¦¯à§‹à¦—à§à¦¯ à¦¹à¦¬à§‡ à¦¨à¦¾"></li>
            <li class="lang-text" data-en="Any fraudulent activity will result in disqualification" data-bn="à¦¯à§‡à¦•à§‹à¦¨ à¦…à¦¸à§Ž à¦•à¦°à§à¦®à¦•à¦¾à¦£à§à¦¡à§‡ à¦…à¦‚à¦¶à¦—à§à¦°à¦¹à¦£ à¦¬à¦¾à¦¤à¦¿à¦² à¦•à¦°à¦¾ à¦¹à¦¬à§‡"></li>
        </ul>
        <div style="margin-top: 20px; display: flex; gap: 10px;">
            <button class="btn btn-primary" onclick="closeRules()" style="flex: 1;">
                <span class="lang-text" data-en="OK" data-bn="à¦ à¦¿à¦• à¦†à¦›à§‡"></span>
            </button>
        </div>
    </div>
</div>

<!-- Main Container -->
<div class="container" id="mainContainer">
    
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <div class="logo">
                <i class="fas fa-heart"></i>
            </div>
            <h1 class="lang-text" data-en="Valentine 2026" data-bn="à¦­à§à¦¯à¦¾à¦²à§‡à¦¨à§à¦Ÿà¦¾à¦‡à¦¨ à§¨à§¦à§¨à§¬"></h1>
            <p class="subtitle lang-text" data-en="Special Love Competition" data-bn="à¦­à¦¾à¦²à§‹à¦¬à¦¾à¦¸à¦¾à¦° à¦¬à¦¿à¦¶à§‡à¦· à¦ªà§à¦°à¦¤à¦¿à¦¯à§‹à¦—à¦¿à¦¤à¦¾"></p>
            <button class="btn btn-secondary btn-small" onclick="showRules()" style="margin-top: 10px;">
                <i class="fas fa-info-circle"></i> <span class="lang-text" data-en="View Rules" data-bn="à¦¨à¦¿à¦¯à¦¼à¦®à¦¾à¦¬à¦²à§€ à¦¦à§‡à¦–à§à¦¨"></span>
            </button>
        </div>
    </div>

    <!-- Prize Section -->
    <div class="prize-section">
        <div class="prize-title lang-text" data-en="ðŸ† Prize List" data-bn="ðŸ† à¦ªà§à¦°à¦¸à§à¦•à¦¾à¦° à¦¤à¦¾à¦²à¦¿à¦•à¦¾"></div>
        <div class="prize-list">
            <div class="prize-item">
                <div class="lang-text" data-en="1st Prize" data-bn="à§§à¦® à¦ªà§à¦°à¦¸à§à¦•à¦¾à¦°"></div>
                <div class="prize-amount">à§§à§«,à§¦à§¦à§¦à§³</div>
            </div>
            <div class="prize-item">
                <div class="lang-text" data-en="2nd Prize" data-bn="à§¨à¦¯à¦¼ à¦ªà§à¦°à¦¸à§à¦•à¦¾à¦°"></div>
                <div class="prize-amount">à§§,à§¦à§¦à§¦à§³</div>
            </div>
            <div class="prize-item">
                <div class="lang-text" data-en="3rd Prize" data-bn="à§©à¦¯à¦¼ à¦ªà§à¦°à¦¸à§à¦•à¦¾à¦°"></div>
                <div class="prize-amount">à§«à§¦à§¦à§³</div>
            </div>
            <div class="prize-item">
                <div class="lang-text" data-en="70 Gifts" data-bn="à§­à§¦à¦Ÿà¦¿ à¦—à¦¿à¦«à¦Ÿ"></div>
                <div class="lang-text" data-en="Special Prizes" data-bn="à¦¬à¦¿à¦¶à§‡à¦· à¦ªà§à¦°à¦¸à§à¦•à¦¾à¦°"></div>
            </div>
        </div>
    </div>

    <!-- Authentication Toggle -->
    <div class="toggle-switch" id="authToggle">
        <div class="toggle-btn active" onclick="showForm('register')">
            <span class="lang-text" data-en="Registration" data-bn="à¦°à§‡à¦œà¦¿à¦¸à§à¦Ÿà§à¦°à§‡à¦¶à¦¨"></span>
        </div>
        <div class="toggle-btn" onclick="showForm('login')">
            <span class="lang-text" data-en="Login" data-bn="à¦²à¦—à¦‡à¦¨"></span>
        </div>
    </div>

    <!-- Registration Form -->
    <div class="form-section active" id="registerForm">
        <div class="form-title">
            <i class="fas fa-user-plus"></i>
            <span class="lang-text" data-en="Create New Account" data-bn="à¦¨à¦¤à§à¦¨ à¦à¦•à¦¾à¦‰à¦¨à§à¦Ÿ à¦¤à§ˆà¦°à¦¿ à¦•à¦°à§à¦¨"></span>
        </div>
        
        <div class="input-group">
            <label class="input-label lang-text" data-en="Your Name *" data-bn="à¦†à¦ªà¦¨à¦¾à¦° à¦¨à¦¾à¦® *"></label>
            <input type="text" id="regName" class="input-field" placeholder="" data-en-placeholder="Enter full name" data-bn-placeholder="à¦ªà§à¦°à§‹ à¦¨à¦¾à¦® à¦²à¦¿à¦–à§à¦¨">
        </div>
        
        <div class="input-group">
            <label class="input-label lang-text" data-en="Email Address *" data-bn="à¦‡à¦®à§‡à¦‡à¦² à¦ à¦¿à¦•à¦¾à¦¨à¦¾ *"></label>
            <input type="email" id="regEmail" class="input-field" placeholder="" data-en-placeholder="example@gmail.com" data-bn-placeholder="example@gmail.com">
        </div>
        
        <div class="input-group">
            <label class="input-label lang-text" data-en="Password *" data-bn="à¦ªà¦¾à¦¸à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡ *"></label>
            <input type="password" id="regPassword" class="input-field" placeholder="" data-en-placeholder="Strong password" data-bn-placeholder="à¦¶à¦•à§à¦¤à¦¿à¦¶à¦¾à¦²à§€ à¦ªà¦¾à¦¸à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡ à¦¦à¦¿à¦¨">
        </div>
        
        <div class="input-group">
            <label class="input-label lang-text" data-en="Are you Couple or Single? *" data-bn="à¦†à¦ªà¦¨à¦¿ à¦•à¦¾à¦ªà¦² à¦¨à¦¾à¦•à¦¿ à¦¸à¦¿à¦™à§à¦—à§‡à¦²? *"></label>
            <select id="regType" class="select-field" onchange="togglePartnerField()">
                <option value="single" class="lang-text" data-en="Single" data-bn="à¦¸à¦¿à¦™à§à¦—à§‡à¦²"></option>
                <option value="couple" class="lang-text" data-en="Couple" data-bn="à¦•à¦¾à¦ªà¦²"></option>
            </select>
        </div>
        
        <div class="input-group" id="partnerField" style="display: none;">
            <label class="input-label lang-text" data-en="Your Partner's Name *" data-bn="à¦†à¦ªà¦¨à¦¾à¦° à¦ªà¦¾à¦°à§à¦Ÿà¦¨à¦¾à¦°à§‡à¦° à¦¨à¦¾à¦® *"></label>
            <input type="text" id="regPartner" class="input-field" placeholder="" data-en-placeholder="Enter partner's name" data-bn-placeholder="à¦ªà¦¾à¦°à§à¦Ÿà¦¨à¦¾à¦°à§‡à¦° à¦¨à¦¾à¦® à¦²à¦¿à¦–à§à¦¨">
        </div>
        
        <div class="input-group">
            <label class="input-label lang-text" data-en="Referral Code (If any)" data-bn="à¦°à§‡à¦«à¦¾à¦°à§‡à¦² à¦•à§‹à¦¡ (à¦¯à¦¦à¦¿ à¦¥à¦¾à¦•à§‡)"></label>
            <input type="text" id="regReferral" class="input-field" placeholder="" data-en-placeholder="Referral code" data-bn-placeholder="à¦°à§‡à¦«à¦¾à¦°à§‡à¦² à¦•à§‹à¦¡">
        </div>
        
        <button class="btn btn-primary" onclick="registerUser()">
            <i class="fas fa-user-check"></i>
            <span class="lang-text" data-en="Complete Registration" data-bn="à¦°à§‡à¦œà¦¿à¦¸à§à¦Ÿà§à¦°à§‡à¦¶à¦¨ à¦¸à¦®à§à¦ªà¦¨à§à¦¨ à¦•à¦°à§à¦¨"></span>
        </button>
        
        <p style="text-align: center; margin-top: 15px; font-size: 0.9rem; color: var(--text-light);">
            <span class="lang-text" data-en="By registering, you agree to our" data-bn="à¦°à§‡à¦œà¦¿à¦¸à§à¦Ÿà§à¦°à§‡à¦¶à¦¨ à¦•à¦°à¦²à§‡ à¦†à¦ªà¦¨à¦¿ à¦†à¦®à¦¾à¦¦à§‡à¦°"></span>
            <a href="#" onclick="showRules()" style="color: var(--primary-color);">
                <span class="lang-text" data-en="Rules & Conditions" data-bn="à¦¨à¦¿à¦¯à¦¼à¦®à¦¾à¦¬à¦²à§€"></span>
            </a>
        </p>
    </div>

    <!-- Login Form -->
    <div class="form-section" id="loginForm">
        <div class="form-title">
            <i class="fas fa-sign-in-alt"></i>
            <span class="lang-text" data-en="Login" data-bn="à¦²à¦—à¦‡à¦¨ à¦•à¦°à§à¦¨"></span>
        </div>
        
        <div class="input-group">
            <label class="input-label lang-text" data-en="Email Address" data-bn="à¦‡à¦®à§‡à¦‡à¦² à¦ à¦¿à¦•à¦¾à¦¨à¦¾"></label>
            <input type="email" id="loginEmail" class="input-field" placeholder="" data-en-placeholder="Enter your email" data-bn-placeholder="à¦†à¦ªà¦¨à¦¾à¦° à¦‡à¦®à§‡à¦‡à¦² à¦¦à¦¿à¦¨">
        </div>
        
        <div class="input-group">
            <label class="input-label lang-text" data-en="Password" data-bn="à¦ªà¦¾à¦¸à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡"></span></label>
            <input type="password" id="loginPassword" class="input-field" placeholder="" data-en-placeholder="Enter your password" data-bn-placeholder="à¦†à¦ªà¦¨à¦¾à¦° à¦ªà¦¾à¦¸à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡ à¦¦à¦¿à¦¨">
        </div>
        
        <button class="btn btn-primary" onclick="loginUser()">
            <i class="fas fa-sign-in-alt"></i>
            <span class="lang-text" data-en="Login" data-bn="à¦²à¦—à¦‡à¦¨ à¦•à¦°à§à¦¨"></span>
        </button>
    </div>

    <!-- Dashboard (Visible after login) -->
    <div class="dashboard" id="userDashboard">
        
        <!-- User Info -->
        <div class="user-info-card">
            <div class="user-name" id="dashboardName"></div>
            <div class="user-type" id="dashboardType"></div>
            <div style="font-size: 0.9rem; opacity: 0.9;">
                <i class="fas fa-envelope"></i> <span id="dashboardEmail"></span>
            </div>
            <div style="margin-top: 10px; display: flex; gap: 10px; flex-wrap: wrap;">
                <span style="font-size: 0.8rem; background: rgba(255,255,255,0.2); padding: 4px 8px; border-radius: 4px;">
                    <i class="fas fa-id-card"></i> <span id="userCode"></span>
                </span>
                <button class="btn-small" onclick="logoutUser()" style="background: rgba(255,255,255,0.2); color: white; border: none;">
                    <i class="fas fa-sign-out-alt"></i> <span class="lang-text" data-en="Logout" data-bn="à¦²à¦—à¦†à¦‰à¦Ÿ"></span>
                </button>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-label">
                <span class="lang-text" data-en="Daily Progress" data-bn="à¦¦à§ˆà¦¨à¦¿à¦• à¦…à¦—à§à¦°à¦—à¦¤à¦¿"></span>
                <span><span id="dailyCompleted">0</span>/60 <span class="lang-text" data-en="Tasks" data-bn="à¦Ÿà¦¾à¦¸à§à¦•"></span></span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="dailyProgressFill" style="width: 0%"></div>
            </div>
        </div>

        <!-- Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" id="statPoints">0</div>
                <div class="stat-label lang-text" data-en="Points" data-bn="à¦ªà¦¯à¦¼à§‡à¦¨à§à¦Ÿ"></div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="statTasks">0/20</div>
                <div class="stat-label lang-text" data-en="Tasks Done" data-bn="à¦Ÿà¦¾à¦¸à§à¦• à¦¸à¦®à§à¦ªà¦¨à§à¦¨"></div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="statInvites">0</div>
                <div class="stat-label lang-text" data-en="Invites" data-bn="à¦‡à¦¨à¦­à¦¾à¦‡à¦Ÿ"></div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="statRank">-</div>
                <div class="stat-label lang-text" data-en="Rank" data-bn="à¦°â€à§à¦¯à¦¾à¦‚à¦•"></div>
            </div>
        </div>

        <!-- Timer Display -->
        <div class="timer-display" id="timerDisplay">
            <div class="timer-text" id="timerText">15</div>
            <div class="lang-text" data-en="Visiting task... Don't close the page!" data-bn="à¦Ÿà¦¾à¦¸à§à¦• à¦¦à§‡à¦–à§à¦¨... à¦ªà§‡à¦œ à¦•à§à¦²à§‹à¦œ à¦•à¦°à¦¬à§‡à¦¨ à¦¨à¦¾!"></div>
        </div>

        <!-- Tasks Section -->
        <div class="tasks-section">
            <div class="form-title">
                <i class="fas fa-tasks"></i>
                <span class="lang-text" data-en="Task List" data-bn="à¦Ÿà¦¾à¦¸à§à¦• à¦¤à¦¾à¦²à¦¿à¦•à¦¾"></span>
                <span style="margin-left: auto; font-size: 0.9rem; color: var(--text-light);">
                    <span class="lang-text" data-en="Today Completed" data-bn="à¦†à¦œ à¦¸à¦®à§à¦ªà¦¨à§à¦¨"></span>: <span id="todayTasks">0</span>/60
                </span>
            </div>
            
            <!-- Task Filters -->
            <div class="task-filters">
                <button class="filter-btn active" onclick="filterTasks('all')">
                    <span class="lang-text" data-en="All" data-bn="à¦¸à¦¬"></span>
                </button>
                <button class="filter-btn" onclick="filterTasks('available')">
                    <span class="lang-text" data-en="Available" data-bn="à¦‰à¦ªà¦²à¦¬à§à¦§"></span>
                </button>
                <button class="filter-btn" onclick="filterTasks('completed')">
                    <span class="lang-text" data-en="Completed" data-bn="à¦¸à¦®à§à¦ªà¦¨à§à¦¨"></span>
                </button>
                <button class="filter-btn" onclick="filterTasks('round1')">
                    <span class="lang-text" data-en="Round 1" data-bn="à¦°à¦¾à¦‰à¦¨à§à¦¡ à§§"></span>
                </button>
                <button class="filter-btn" onclick="filterTasks('round2')">
                    <span class="lang-text" data-en="Round 2" data-bn="à¦°à¦¾à¦‰à¦¨à§à¦¡ à§¨"></span>
                </button>
                <button class="filter-btn" onclick="filterTasks('round3')">
                    <span class="lang-text" data-en="Round 3" data-bn="à¦°à¦¾à¦‰à¦¨à§à¦¡ à§©"></span>
                </button>
            </div>
            
            <div id="tasksList">
                <!-- Tasks will be loaded here -->
                <div class="loading-spinner" id="tasksLoading"></div>
            </div>
        </div>

        <!-- Referral Section -->
        <div class="referral-section">
            <div class="form-title">
                <i class="fas fa-share-alt"></i>
                <span class="lang-text" data-en="Invite Friends" data-bn="à¦¬à¦¨à§à¦§à§à¦¦à§‡à¦° à¦†à¦®à¦¨à§à¦¤à§à¦°à¦£ à¦œà¦¾à¦¨à¦¾à¦¨"></span>
            </div>
            
            <p style="margin-bottom: 15px; color: var(--text-light);">
                <i class="fas fa-info-circle"></i> 
                <span class="lang-text" data-en="Invite at least 30 friends (20 couples if you are a couple)" data-bn="à¦•à¦®à¦ªà¦•à§à¦·à§‡ à§©à§¦ à¦œà¦¨ à¦¬à¦¨à§à¦§à§à¦•à§‡ à¦†à¦®à¦¨à§à¦¤à§à¦°à¦£ à¦œà¦¾à¦¨à¦¾à¦¨ (à¦•à¦¾à¦ªà¦² à¦¹à¦²à§‡ à§¨à§¦ à¦•à¦¾à¦ªà¦²)"></span>
            </p>
            
            <div class="referral-link-box">
                <div class="referral-link" id="referralLink"></div>
                <button class="copy-btn" id="copyButton" onclick="copyReferralLink()">
                    <i class="fas fa-copy"></i> 
                    <span class="lang-text" data-en="Copy" data-bn="à¦•à¦ªà¦¿"></span>
                </button>
            </div>
            
            <div class="referral-message">
                <strong class="lang-text" data-en="Your Referral Message:" data-bn="à¦†à¦ªà¦¨à¦¾à¦° à¦°à§‡à¦«à¦¾à¦°à§‡à¦² à¦®à§‡à¦¸à§‡à¦œ:"></strong><br>
                <div id="referralMessage" style="margin-top: 8px; font-size: 0.85rem; white-space: pre-line;"></div>
            </div>
            
            <div style="margin-top: 15px; display: flex; gap: 10px;">
                <button class="btn btn-secondary" onclick="shareOnFacebook()">
                    <i class="fab fa-facebook"></i> Facebook
                </button>
                <button class="btn btn-secondary" onclick="shareOnWhatsApp()">
                    <i class="fab fa-whatsapp"></i> WhatsApp
                </button>
            </div>
        </div>

        <!-- Leaderboard -->
        <div class="leaderboard-section">
            <div class="form-title">
                <i class="fas fa-trophy"></i>
                <span class="lang-text" data-en="Leaderboard" data-bn="à¦²à¦¿à¦¡à¦¾à¦°à¦¬à§‹à¦°à§à¦¡"></span>
            </div>
            
            <div id="leaderboardList">
                <!-- Leaderboard will be loaded here -->
                <div class="loading-spinner" id="leaderboardLoading"></div>
            </div>
        </div>

        <!-- Payment Form -->
        <div class="payment-section">
            <div class="form-title">
                <i class="fas fa-money-bill-wave"></i>
                <span class="lang-text" data-en="Payment Information (For Winners)" data-bn="à¦ªà§‡à¦®à§‡à¦¨à§à¦Ÿ à¦¤à¦¥à§à¦¯ (à¦¬à¦¿à¦œà¦¯à¦¼à§€à¦¦à§‡à¦° à¦œà¦¨à§à¦¯)"></span>
            </div>
            
            <p style="margin-bottom: 15px; color: var(--text-light); font-size: 0.9rem;">
                <span class="lang-text" data-en="This information will be required to receive prizes if you win" data-bn="à¦¬à¦¿à¦œà¦¯à¦¼à§€ à¦¹à¦²à§‡ à¦ªà§à¦°à¦¸à§à¦•à¦¾à¦° à¦ªà§‡à¦¤à§‡ à¦à¦‡ à¦¤à¦¥à§à¦¯à¦—à§à¦²à§‹ à¦ªà§à¦°à¦¯à¦¼à§‹à¦œà¦¨ à¦¹à¦¬à§‡"></span>
            </p>
            
            <div class="input-group">
                <label class="input-label lang-text" data-en="Mobile Banking Name" data-bn="à¦®à§‹à¦¬à¦¾à¦‡à¦² à¦¬à§à¦¯à¦¾à¦‚à¦• à¦¨à¦¾à¦®"></label>
                <select id="paymentMethod" class="select-field">
                    <option value="" class="lang-text" data-en="Select" data-bn="à¦¸à¦¿à¦²à§‡à¦•à§à¦Ÿ à¦•à¦°à§à¦¨"></option>
                    <option value="bkash">à¦¬à¦¿à¦•à¦¾à¦¶ (bKash)</option>
                    <option value="nagad">à¦¨à¦—à¦¦ (Nagad)</option>
                    <option value="rocket">à¦°à¦•à§‡à¦Ÿ (Rocket)</option>
                    <option value="upay">à¦‰à¦ªà¦¾à¦¯à¦¼ (Upay)</option>
                </select>
            </div>
            
            <div class="input-group">
                <label class="input-label lang-text" data-en="Mobile Number" data-bn="à¦®à§‹à¦¬à¦¾à¦‡à¦² à¦¨à¦®à§à¦¬à¦°"></label>
                <input type="text" id="paymentNumber" class="input-field" placeholder="017XXXXXXXX">
            </div>
            
            <div class="input-group">
                <label class="input-label lang-text" data-en="Full Address" data-bn="à¦ªà§‚à¦°à§à¦£ à¦ à¦¿à¦•à¦¾à¦¨à¦¾"></label>
                <textarea id="userAddress" class="input-field" placeholder="" rows="3" data-en-placeholder="Enter full address" data-bn-placeholder="à¦ªà§‚à¦°à§à¦£ à¦ à¦¿à¦•à¦¾à¦¨à¦¾ à¦²à¦¿à¦–à§à¦¨"></textarea>
            </div>
            
            <button class="btn btn-success" onclick="savePaymentInfo()">
                <i class="fas fa-save"></i>
                <span class="lang-text" data-en="Save Information" data-bn="à¦¤à¦¥à§à¦¯ à¦¸à§‡à¦­ à¦•à¦°à§à¦¨"></span>
            </button>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p class="lang-text" data-en="Valentine 2026 - Special Love Competition" data-bn="à¦­à§à¦¯à¦¾à¦²à§‡à¦¨à§à¦Ÿà¦¾à¦‡à¦¨ à§¨à§¦à§¨à§¬ - à¦­à¦¾à¦²à§‹à¦¬à¦¾à¦¸à¦¾à¦° à¦¬à¦¿à¦¶à§‡à¦· à¦ªà§à¦°à¦¤à¦¿à¦¯à§‹à¦—à¦¿à¦¤à¦¾"></p>
            <p style="margin-top: 5px; font-size: 0.75rem; opacity: 0.7;">
                Â© à§¨à§¦à§¨à§¬ <span class="lang-text" data-en="All rights reserved" data-bn="à¦¸à¦°à§à¦¬à¦¸à§à¦¬à¦¤à§à¦¬ à¦¸à¦‚à¦°à¦•à§à¦·à¦¿à¦¤"></span> | 
                <span class="lang-text" data-en="Winners will be announced on February 14" data-bn="à¦¬à¦¿à¦œà¦¯à¦¼à§€à¦¦à§‡à¦° à¦¤à¦¾à¦²à¦¿à¦•à¦¾ à§§à§ªà¦‡ à¦«à§‡à¦¬à§à¦°à§à¦¯à¦¼à¦¾à¦°à¦¿ à¦ªà§à¦°à¦•à¦¾à¦¶à¦¿à¦¤ à¦¹à¦¬à§‡"></span>
            </p>
        </div>
    </div>
</div>

<!-- Notification -->
<div class="notification" id="notification">
    <i class="fas fa-check-circle"></i>
    <span id="notificationText"></span>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
    // Firebase Configuration
    const firebaseConfig = {
        apiKey: "AIzaSyAxvrjzR-79a4SlbS_Kq6ugnrikN4M_Xuw",
        authDomain: "adclickearn-898a8.firebaseapp.com",
        databaseURL: "https://adclickearn-898a8-default-rtdb.firebaseio.com",
        projectId: "adclickearn-898a8",
        storageBucket: "adclickearn-898a8.firebasestorage.app",
        messagingSenderId: "554825480191",
        appId: "1:554825480191:web:a99a7526a38fdba4ccd9ca",
        measurementId: "G-LZDJ2G5Q8V"
    };

    // Initialize Firebase
    if (!firebase.apps.length) {
        firebase.initializeApp(firebaseConfig);
    }
    
    const auth = firebase.auth();
    const db = firebase.database();

    // Global Variables
    let currentUser = null;
    let userData = null;
    let activeTaskTimer = null;
    let taskCountdown = 15;
    let currentTaskId = null;
    let dailyTasks = 0;
    let currentLanguage = 'bn'; // Default: Bangla
    let allTasks = [];
    let userTaskStatus = {};

    // Language Management
    function toggleLanguage() {
        currentLanguage = currentLanguage === 'bn' ? 'en' : 'bn';
        updateLanguage();
    }

    function updateLanguage() {
        // Update body class
        document.body.className = currentLanguage === 'en' ? 'english' : '';
        
        // Update language button
        document.getElementById('currentLang').textContent = currentLanguage === 'bn' ? 'à¦¬à¦¾à¦‚à¦²à¦¾' : 'English';
        
        // Update all language-aware elements
        document.querySelectorAll('.lang-text').forEach(element => {
            const text = element.getAttribute(`data-${currentLanguage}`);
            if (text) element.textContent = text;
        });
        
        // Update placeholders
        document.querySelectorAll('[data-en-placeholder]').forEach(element => {
            const placeholder = element.getAttribute(`data-${currentLanguage}-placeholder`);
            if (placeholder) element.placeholder = placeholder;
        });
        
        // Update select options
        document.querySelectorAll('option.lang-text').forEach(option => {
            const text = option.getAttribute(`data-${currentLanguage}`);
            if (text) option.textContent = text;
        });
        
        // Update dashboard if loaded
        if (userData) {
            updateDashboardLanguage();
        }
    }

    function updateDashboardLanguage() {
        // Update referral message
        if (userData) {
            updateReferralMessage();
        }
    }

    // Show/Hide Forms
    function showForm(formType) {
        document.querySelectorAll('.form-section').forEach(form => {
            form.classList.remove('active');
        });
        
        document.querySelectorAll('.toggle-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        
        if (formType === 'register') {
            document.getElementById('registerForm').classList.add('active');
            document.querySelectorAll('.toggle-btn')[0].classList.add('active');
        } else {
            document.getElementById('loginForm').classList.add('active');
            document.querySelectorAll('.toggle-btn')[1].classList.add('active');
        }
    }

    // Toggle Partner Field
    function togglePartnerField() {
        const type = document.getElementById('regType').value;
        const partnerField = document.getElementById('partnerField');
        partnerField.style.display = type === 'couple' ? 'block' : 'none';
    }

    // Show Rules
    function showRules() {
        document.getElementById('rulesModal').style.display = 'flex';
    }

    function closeRules() {
        document.getElementById('rulesModal').style.display = 'none';
    }

    // Show Notification
    function showNotification(message, type = 'success') {
        const notification = document.getElementById('notification');
        const notificationText = document.getElementById('notificationText');
        
        notificationText.textContent = message;
        notification.style.background = type === 'success' ? 'var(--success-color)' : 
                                      type === 'error' ? 'var(--danger-color)' : 
                                      'var(--warning-color)';
        
        notification.style.display = 'flex';
        
        setTimeout(() => {
            notification.style.display = 'none';
        }, 3000);
    }

    // Generate Referral Code
    function generateReferralCode() {
        const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
        let code = '';
        for (let i = 0; i < 6; i++) {
            code += chars.charAt(Math.floor(Math.random() * chars.length));
        }
        return code;
    }

    // Register User
    function registerUser() {
        const name = document.getElementById('regName').value.trim();
        const email = document.getElementById('regEmail').value.trim();
        const password = document.getElementById('regPassword').value;
        const type = document.getElementById('regType').value;
        const partner = document.getElementById('regPartner').value.trim();
        const referralCode = document.getElementById('regReferral').value.trim().toUpperCase();

        if (!name || !email || !password) {
            Swal.fire({
                icon: 'error',
                title: currentLanguage === 'bn' ? 'à¦¤à§à¦°à§à¦Ÿà¦¿' : 'Error',
                text: currentLanguage === 'bn' ? 'à¦¸à¦®à¦¸à§à¦¤ à¦¤à¦¥à§à¦¯ à¦ªà§‚à¦°à¦£ à¦•à¦°à§à¦¨' : 'Please fill all information'
            });
            return;
        }

        if (type === 'couple' && !partner) {
            Swal.fire({
                icon: 'error',
                title: currentLanguage === 'bn' ? 'à¦¤à§à¦°à§à¦Ÿà¦¿' : 'Error',
                text: currentLanguage === 'bn' ? 'à¦ªà¦¾à¦°à§à¦Ÿà¦¨à¦¾à¦°à§‡à¦° à¦¨à¦¾à¦® à¦¦à¦¿à¦¨' : 'Enter partner name'
            });
            return;
        }

        Swal.fire({
            title: currentLanguage === 'bn' ? 'à¦°à§‡à¦œà¦¿à¦¸à§à¦Ÿà§à¦°à§‡à¦¶à¦¨ à¦šà¦²à¦›à§‡...' : 'Registering...',
            text: currentLanguage === 'bn' ? 'à¦…à¦ªà§‡à¦•à§à¦·à¦¾ à¦•à¦°à§à¦¨' : 'Please wait',
            allowOutsideClick: false,
            didOpen: () => {
                Swal.showLoading();
            }
        });

        // Create user with email and password
        auth.createUserWithEmailAndPassword(email, password)
            .then((userCredential) => {
                const user = userCredential.user;
                
                // Generate unique referral code
                const userReferralCode = generateReferralCode();
                
                // Save user data to database
                const userData = {
                    name: name,
                    email: email,
                    type: type,
                    partnerName: type === 'couple' ? partner : '',
                    points: 0,
                    invites: 0,
                    tasksCompleted: 0,
                    referralCode: userReferralCode,
                    referralBy: referralCode || '',
                    createdAt: new Date().toISOString(),
                    lastLogin: new Date().toISOString(),
                    paymentMethod: '',
                    paymentNumber: '',
                    address: '',
                    dailyTaskCount: 0,
                    lastTaskDate: '',
                    totalPoints: 0,
                    language: currentLanguage
                };
                
                db.ref('users/' + user.uid).set(userData)
                    .then(() => {
                        // If referral code provided, update referrer's invites
                        if (referralCode) {
                            db.ref('users').orderByChild('referralCode').equalTo(referralCode).once('value')
                                .then(snapshot => {
                                    if (snapshot.exists()) {
                                        const referrerData = Object.values(snapshot.val())[0];
                                        const referrerId = Object.keys(snapshot.val())[0];
                                        const newInvites = (referrerData.invites || 0) + 1;
                                        const newPoints = (referrerData.points || 0) + 50;
                                        
                                        db.ref('users/' + referrerId).update({
                                            invites: newInvites,
                                            points: newPoints,
                                            totalPoints: (referrerData.totalPoints || 0) + 50
                                        });
                                        
                                        // Also give bonus to new user
                                        db.ref('users/' + user.uid).update({
                                            points: 50,
                                            totalPoints: 50
                                        });
                                    }
                                });
                        }
                        
                        Swal.fire({
                            icon: 'success',
                            title: currentLanguage === 'bn' ? 'à¦¸à¦«à¦²!' : 'Success!',
                            text: currentLanguage === 'bn' ? 'à¦°à§‡à¦œà¦¿à¦¸à§à¦Ÿà§à¦°à§‡à¦¶à¦¨ à¦¸à¦®à§à¦ªà¦¨à§à¦¨ à¦¹à¦¯à¦¼à§‡à¦›à§‡' : 'Registration completed successfully'
                        });
                        loadDashboard();
                    })
                    .catch(error => {
                        Swal.fire({
                            icon: 'error',
                            title: currentLanguage === 'bn' ? 'à¦¤à§à¦°à§à¦Ÿà¦¿' : 'Error',
                            text: error.message
                        });
                    });
            })
            .catch(error => {
                Swal.fire({
                    icon: 'error',
                    title: currentLanguage === 'bn' ? 'à¦¤à§à¦°à§à¦Ÿà¦¿' : 'Error',
                    text: error.message
                });
            });
    }

    // Login User
    function loginUser() {
        const email = document.getElementById('loginEmail').value.trim();
        const password = document.getElementById('loginPassword').value;

        if (!email || !password) {
            Swal.fire({
                icon: 'error',
                title: currentLanguage === 'bn' ? 'à¦¤à§à¦°à§à¦Ÿà¦¿' : 'Error',
                text: currentLanguage === 'bn' ? 'à¦‡à¦®à§‡à¦‡à¦² à¦“ à¦ªà¦¾à¦¸à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡ à¦¦à¦¿à¦¨' : 'Enter email and password'
            });
            return;
        }

        Swal.fire({
            title: currentLanguage === 'bn' ? 'à¦²à¦—à¦‡à¦¨ à¦šà¦²à¦›à§‡...' : 'Logging in...',
            text: currentLanguage === 'bn' ? 'à¦…à¦ªà§‡à¦•à§à¦·à¦¾ à¦•à¦°à§à¦¨' : 'Please wait',
            allowOutsideClick: false,
            didOpen: () => {
                Swal.showLoading();
            }
        });

        auth.signInWithEmailAndPassword(email, password)
            .then((userCredential) => {
                // Update last login
                db.ref('users/' + userCredential.user.uid + '/lastLogin').set(new Date().toISOString());
                
                Swal.fire({
                    icon: 'success',
                    title: currentLanguage === 'bn' ? 'à¦¸à¦«à¦²!' : 'Success!',
                    text: currentLanguage === 'bn' ? 'à¦²à¦—à¦‡à¦¨ à¦¸à¦®à§à¦ªà¦¨à§à¦¨ à¦¹à¦¯à¦¼à§‡à¦›à§‡' : 'Login successful'
                });
                loadDashboard();
            })
            .catch(error => {
                Swal.fire({
                    icon: 'error',
                    title: currentLanguage === 'bn' ? 'à¦¤à§à¦°à§à¦Ÿà¦¿' : 'Error',
                    text: error.message
                });
            });
    }

    // Load Dashboard
    function loadDashboard() {
        currentUser = auth.currentUser;
        
        if (!currentUser) {
            return;
        }

        // Get user data
        db.ref('users/' + currentUser.uid).on('value', snapshot => {
            userData = snapshot.val();
            
            if (userData) {
                // Update language preference
                if (userData.language && userData.language !== currentLanguage) {
                    currentLanguage = userData.language;
                    updateLanguage();
                }
                
                // Show dashboard, hide auth forms
                document.getElementById('authToggle').style.display = 'none';
                document.getElementById('registerForm').style.display = 'none';
                document.getElementById('loginForm').style.display = 'none';
                document.getElementById('userDashboard').style.display = 'block';
                
                // Update user info
                document.getElementById('dashboardName').textContent = userData.name;
                document.getElementById('dashboardEmail').textContent = userData.email;
                document.getElementById('dashboardType').textContent = userData.type === 'couple' ? 
                    (currentLanguage === 'bn' ? 'à¦•à¦¾à¦ªà¦²' : 'Couple') : 
                    (currentLanguage === 'bn' ? 'à¦¸à¦¿à¦™à§à¦—à§‡à¦²' : 'Single');
                document.getElementById('dashboardType').style.background = userData.type === 'couple' ? 'rgba(233, 30, 99, 0.3)' : 'rgba(156, 39, 176, 0.3)';
                
                document.getElementById('userCode').textContent = userData.referralCode;
                
                // Update stats
                document.getElementById('statPoints').textContent = userData.points || 0;
                document.getElementById('statTasks').textContent = (userData.tasksCompleted || 0) + '/20';
                document.getElementById('statInvites').textContent = userData.invites || 0;
                
                // Update referral link
                const baseUrl = window.location.origin + window.location.pathname;
                const referralLink = baseUrl + '?ref=' + userData.referralCode;
                document.getElementById('referralLink').textContent = referralLink;
                
                // Update referral message
                updateReferralMessage();
                
                // Update daily progress
                updateDailyProgress();
                
                // Load tasks
                loadTasks();
                
                // Load leaderboard
                loadLeaderboard();
                
                // Load payment info if exists
                if (userData.paymentMethod) {
                    document.getElementById('paymentMethod').value = userData.paymentMethod;
                }
                if (userData.paymentNumber) {
                    document.getElementById('paymentNumber').value = userData.paymentNumber;
                }
                if (userData.address) {
                    document.getElementById('userAddress').value = userData.address;
                }
            }
        });
    }

    // Update Referral Message
    function updateReferralMessage() {
        const referralLink = document.getElementById('referralLink').textContent;
        const isBangla = currentLanguage === 'bn';
        
        const message = isBangla ? 
`à¦ªà§à¦°à¦¿à¦¯à¦¼ à¦¬à¦¨à§à¦§à§,

à§¨à§¦à§¨à§¬ à¦¸à¦¾à¦²à§‡à¦° Valentine's Day à¦‰à¦ªà¦²à¦•à§à¦·à§à¦¯à§‡ à¦à¦•à¦Ÿà¦¿ à¦¬à¦¿à¦¶à§‡à¦· à¦ªà§à¦°à¦¤à¦¿à¦¯à§‹à¦—à¦¿à¦¤à¦¾à¦° à¦†à¦¯à¦¼à§‹à¦œà¦¨ à¦•à¦°à¦¾ à¦¹à¦¯à¦¼à§‡à¦›à§‡à¥¤ 
à¦à¦‡ à¦ªà§à¦°à¦¤à¦¿à¦¯à§‹à¦—à¦¿à¦¤à¦¾à¦¯à¦¼ à¦…à¦‚à¦¶à¦—à§à¦°à¦¹à¦£ à¦•à¦°à§‡ à¦†à¦ªà¦¨à¦¿ à¦œà¦¿à¦¤à¦¤à§‡ à¦ªà¦¾à¦°à§‡à¦¨ à¦†à¦•à¦°à§à¦·à¦£à§€à¦¯à¦¼ à¦¨à¦—à¦¦ à¦ªà§à¦°à¦¸à§à¦•à¦¾à¦°à¥¤

ðŸŽ¯ à¦ªà§à¦°à¦¤à¦¿à¦¯à§‹à¦—à¦¿à¦¤à¦¾à¦° à¦¬à¦¿à¦¬à¦°à¦£:
â€¢ à§§à¦® à¦ªà§à¦°à¦¸à§à¦•à¦¾à¦°: à§§à§«,à§¦à§¦à§¦à§³
â€¢ à§¨à¦¯à¦¼ à¦ªà§à¦°à¦¸à§à¦•à¦¾à¦°: à§§,à§¦à§¦à§¦à§³  
â€¢ à§©à¦¯à¦¼ à¦ªà§à¦°à¦¸à§à¦•à¦¾à¦°: à§«à§¦à§¦à§³
â€¢ à¦†à¦°à¦“ à§­à§¦à¦Ÿà¦¿ à¦¸à§à¦ªà§‡à¦¶à¦¾à¦² à¦—à¦¿à¦«à¦Ÿ

âœ… à¦…à¦‚à¦¶à¦—à§à¦°à¦¹à¦£ à¦ªà¦¦à§à¦§à¦¤à¦¿:
1. à¦¨à¦¿à¦šà§‡à¦° à¦²à¦¿à¦‚à¦•à§‡ à¦•à§à¦²à¦¿à¦• à¦•à¦°à§‡ à¦°à§‡à¦œà¦¿à¦¸à§à¦Ÿà§à¦°à§‡à¦¶à¦¨ à¦•à¦°à§à¦¨
2. à¦¸à¦¹à¦œ à¦Ÿà¦¾à¦¸à§à¦•à¦—à§à¦²à§‹ à¦¸à¦®à§à¦ªà¦¨à§à¦¨ à¦•à¦°à§à¦¨ (à¦ªà§à¦°à¦¤à¦¿à¦¦à¦¿à¦¨ à§¬à§¦à¦Ÿà¦¿)
3. à¦¬à¦¨à§à¦§à§à¦¦à§‡à¦° à¦†à¦®à¦¨à§à¦¤à§à¦°à¦£ à¦œà¦¾à¦¨à¦¾à¦¨
4. à¦ªà¦¯à¦¼à§‡à¦¨à§à¦Ÿà¦¸ à¦œà¦®à¦¾ à¦•à¦°à§‡ à¦ªà§à¦°à¦¸à§à¦•à¦¾à¦° à¦œà¦¿à¦¤à§à¦¨

ðŸ”— à¦°à§‡à¦œà¦¿à¦¸à§à¦Ÿà§à¦°à§‡à¦¶à¦¨ à¦²à¦¿à¦‚à¦•: ${referralLink}

à¦†à¦®à¦¾à¦° à¦°à§‡à¦«à¦¾à¦°à§‡à¦² à¦•à§‹à¦¡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦œà¦¯à¦¼à§‡à¦¨ à¦•à¦°à¦²à§‡ à¦†à¦®à¦°à¦¾ à¦‰à¦­à¦¯à¦¼à§‡à¦‡ à¦…à¦¤à¦¿à¦°à¦¿à¦•à§à¦¤ à¦¬à§‹à¦¨à¦¾à¦¸ à¦ªà¦¾à¦¬à§‹à¥¤

à¦§à¦¨à§à¦¯à¦¬à¦¾à¦¦à¦¾à¦¨à§à¦¤à§‡,
${userData.name}

à¦¨à§‹à¦Ÿà¦¿à¦¶:
à¦¯à¦¾à¦¦à§‡à¦° à¦¯à¦¤ à¦¬à§‡à¦¶à¦¿ à¦¶à§‡à¦¯à¦¼à¦¾à¦° à¦¤à¦¾à¦¦à§‡à¦° à¦ªà¦¯à¦¼à§‡à¦¨à§à¦Ÿ à¦¤à¦¤ à¦¬à§‡à¦¶à¦¿ à¦ªà¦¾à¦¬à§‡à¦¨à¥¤ à¦†à¦° à¦ªà¦¯à¦¼à§‡à¦¨à§à¦Ÿ à¦¯à¦¤ à¦¬à§‡à¦¶à¦¿ à¦œà§‡à¦¤à¦¾à¦° à¦¸à¦®à§à¦­à¦¾à¦¬à¦¨à¦¾ à¦¤à¦¤ à¦¬à§‡à¦¶à¦¿à¥¤
à¦‰à¦‡à¦¨à¦¾à¦° à§§à§ª à¦¤à¦¾à¦°à¦¿à¦– à¦˜à§‹à¦·à¦£à¦¾ à¦•à¦°à¦¾ à¦¹à¦¬à§‡à¥¤ 
à¦…à¦¬à¦¶à§à¦¯à¦‡ à¦‡à¦‰à¦œà¦¾à¦°à¦¦à§‡à¦° à¦ªà§‡à¦®à§‡à¦¨à§à¦Ÿ à¦¨à¦‚, à¦ à¦¿à¦•à¦¾à¦¨à¦¾ à¦¸à¦¬ à¦•à¦¿à¦›à§ à¦à¦¡ à¦•à¦°à¦¤à§‡ à¦¹à¦¬à§‡à¥¤` :
`Dear Friend,

A special competition has been organized on the occasion of Valentine's Day 2026.
By participating in this competition, you can win attractive cash prizes.

ðŸŽ¯ Competition Details:
â€¢ 1st Prize: 15,000à§³
â€¢ 2nd Prize: 1,000à§³  
â€¢ 3rd Prize: 500à§³
â€¢ 70 Special Gift Prizes

âœ… Participation Process:
1. Register by clicking the link below
2. Complete simple tasks (60 per day)
3. Invite friends
4. Earn points and win prizes

ðŸ”— Registration Link: ${referralLink}

If you join using my referral code, we will both get extra bonuses.

Thanks,
${userData.name}

Notice:
The more shares you have, the more points you get. And the more points, the higher the chance of winning.
Winners will be announced on the 14th.
Users must add payment numbers, addresses, etc.`;
        
        document.getElementById('referralMessage').textContent = message;
    }

    // Update Daily Progress
    function updateDailyProgress() {
        const today = new Date().toDateString();
        
        if (userData.lastTaskDate !== today) {
            // Reset daily count
            db.ref('users/' + currentUser.uid + '/dailyTaskCount').set(0);
            dailyTasks = 0;
        } else {
            dailyTasks = userData.dailyTaskCount || 0;
        }
        
        document.getElementById('todayTasks').textContent = dailyTasks;
        document.getElementById('dailyCompleted').textContent = dailyTasks;
        
        // Update progress bar
        const progress = Math.min((dailyTasks / 60) * 100, 100);
        document.getElementById('dailyProgressFill').style.width = progress + '%';
    }

    // Load Tasks
    function loadTasks() {
        document.getElementById('tasksLoading').style.display = 'block';
        
        db.ref('tasks').orderByChild('year').equalTo(2026).once('value')
            .then(snapshot => {
                const tasks = snapshot.val();
                allTasks = tasks;
                
                if (tasks) {
                    // Load user task status
                    loadUserTaskStatus().then(() => {
                        displayTasks('all');
                        document.getElementById('tasksLoading').style.display = 'none';
                    });
                } else {
                    document.getElementById('tasksList').innerHTML = 
                        currentLanguage === 'bn' ? 
                        '<p style="text-align: center; padding: 20px; color: var(--text-light);">à¦•à§‹à¦¨ à¦Ÿà¦¾à¦¸à§à¦• à¦ªà¦¾à¦“à¦¯à¦¼à¦¾ à¦¯à¦¾à¦¯à¦¼à¦¨à¦¿</p>' :
                        '<p style="text-align: center; padding: 20px; color: var(--text-light);">No tasks found</p>';
                    document.getElementById('tasksLoading').style.display = 'none';
                }
            });
    }

    // Load User Task Status
    function loadUserTaskStatus() {
        return db.ref('userTasks/' + currentUser.uid).once('value')
            .then(snapshot => {
                userTaskStatus = snapshot.val() || {};
            });
    }

    // Display Tasks with Filter
    function displayTasks(filter) {
        const container = document.getElementById('tasksList');
        container.innerHTML = '';
        
        if (!allTasks) return;
        
        const taskIds = Object.keys(allTasks);
        let displayedTasks = 0;
        
        taskIds.forEach((taskId, index) => {
            const task = allTasks[taskId];
            const taskNumber = index + 1;
            
            // Check task status for all 3 rounds
            const round1Key = `${taskId}_round1`;
            const round2Key = `${taskId}_round2`;
            const round3Key = `${taskId}_round3`;
            
            const round1Completed = userTaskStatus[round1Key]?.completed || false;
            const round2Completed = userTaskStatus[round2Key]?.completed || false;
            const round3Completed = userTaskStatus[round3Key]?.completed || false;
            
            const totalRoundsCompleted = [round1Completed, round2Completed, round3Completed].filter(Boolean).length;
            const canDoRound1 = dailyTasks < 60 && !round1Completed;
            const canDoRound2 = dailyTasks < 60 && round1Completed && !round2Completed;
            const canDoRound3 = dailyTasks < 60 && round2Completed && !round3Completed;
            
            // Apply filter
            let shouldDisplay = true;
            if (filter === 'available') {
                shouldDisplay = canDoRound1 || canDoRound2 || canDoRound3;
            } else if (filter === 'completed') {
                shouldDisplay = round1Completed || round2Completed || round3Completed;
            } else if (filter === 'round1') {
                shouldDisplay = true; // Show all for round1
            } else if (filter === 'round2') {
                shouldDisplay = round1Completed; // Only show if round1 completed
            } else if (filter === 'round3') {
                shouldDisplay = round2Completed; // Only show if round2 completed
            }
            
            if (!shouldDisplay) return;
            
            displayedTasks++;
            
            const taskItem = document.createElement('div');
            taskItem.className = 'task-item';
            taskItem.id = `task-${taskId}`;
            
            // Determine which round is available
            let activeRound = 0;
            let buttonText = '';
            let buttonClass = 'task-btn ';
            
            if (canDoRound1) {
                activeRound = 1;
                buttonText = currentLanguage === 'bn' ? 'à¦°à¦¾à¦‰à¦¨à§à¦¡ à§§ à¦¶à§à¦°à§ à¦•à¦°à§à¦¨' : 'Start Round 1';
                buttonClass += 'available';
            } else if (canDoRound2) {
                activeRound = 2;
                buttonText = currentLanguage === 'bn' ? 'à¦°à¦¾à¦‰à¦¨à§à¦¡ à§¨ à¦¶à§à¦°à§ à¦•à¦°à§à¦¨' : 'Start Round 2';
                buttonClass += 'available';
            } else if (canDoRound3) {
                activeRound = 3;
                buttonText = currentLanguage === 'bn' ? 'à¦°à¦¾à¦‰à¦¨à§à¦¡ à§© à¦¶à§à¦°à§ à¦•à¦°à§à¦¨' : 'Start Round 3';
                buttonClass += 'available';
            } else {
                buttonText = currentLanguage === 'bn' ? 'à¦¸à¦®à§à¦ªà¦¨à§à¦¨ à¦¹à¦¯à¦¼à§‡à¦›à§‡' : 'Completed';
                buttonClass += 'completed';
            }
            
            // Round indicators
            const roundIndicators = `
                <div style="display: flex; gap: 5px; margin-top: 8px;">
                    <span style="font-size: 0.7rem; padding: 2px 6px; border-radius: 10px; background: ${round1Completed ? '#4caf50' : '#e0e0e0'}; color: ${round1Completed ? 'white' : '#666'}">
                        R1
                    </span>
                    <span style="font-size: 0.7rem; padding: 2px 6px; border-radius: 10px; background: ${round2Completed ? '#4caf50' : '#e0e0e0'}; color: ${round2Completed ? 'white' : '#666'}">
                        R2
                    </span>
                    <span style="font-size: 0.7rem; padding: 2px 6px; border-radius: 10px; background: ${round3Completed ? '#4caf50' : '#e0e0e0'}; color: ${round3Completed ? 'white' : '#666'}">
                        R3
                    </span>
                </div>
            `;
            
            taskItem.innerHTML = `
                <div class="task-info">
                    <h4>${taskNumber}. ${task.title}</h4>
                    <div class="task-status">
                        ${totalRoundsCompleted === 3 ? 
                            `<span class="task-completed"><i class="fas fa-check-circle"></i> ${currentLanguage === 'bn' ? 'à¦¸à¦®à§à¦ªà¦¨à§à¦¨' : 'Completed'}</span>` : 
                            `${currentLanguage === 'bn' ? 'à¦…à¦ªà§‡à¦•à§à¦·à¦®à¦¾à¦¨' : 'Pending'} (${totalRoundsCompleted}/3)`
                        }
                    </div>
                    ${roundIndicators}
                </div>
                <button class="${buttonClass}" 
                        onclick="${activeRound > 0 ? `startTask('${taskId}', '${task.url}', ${activeRound})` : ''}"
                        ${activeRound === 0 ? 'disabled' : ''}>
                    ${buttonText}
                </button>
            `;
            
            container.appendChild(taskItem);
        });
        
        if (displayedTasks === 0) {
            container.innerHTML = currentLanguage === 'bn' ? 
                '<p style="text-align: center; padding: 20px; color: var(--text-light);">à¦•à§‹à¦¨ à¦Ÿà¦¾à¦¸à§à¦• à¦ªà¦¾à¦“à¦¯à¦¼à¦¾ à¦¯à¦¾à¦¯à¦¼à¦¨à¦¿</p>' :
                '<p style="text-align: center; padding: 20px; color: var(--text-light);">No tasks available</p>';
        }
    }

    // Filter Tasks
    function filterTasks(filterType) {
        // Update active filter button
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        event.target.classList.add('active');
        
        displayTasks(filterType);
    }

    // Start Task
    function startTask(taskId, url, round) {
        if (dailyTasks >= 60) {
            showNotification(
                currentLanguage === 'bn' ? 
                'à¦†à¦œ à¦†à¦ªà¦¨à¦¿ à¦¸à¦°à§à¦¬à§‹à¦šà§à¦š à§¬à§¦à¦Ÿà¦¿ à¦Ÿà¦¾à¦¸à§à¦• à¦¸à¦®à§à¦ªà¦¨à§à¦¨ à¦•à¦°à§‡à¦›à§‡à¦¨!' : 
                'You have completed maximum 60 tasks today!',
                'error'
            );
            return;
        }
        
        currentTaskId = taskId;
        const roundKey = `${taskId}_round${round}`;
        
        // Open task in new tab
        window.open(url, '_blank');
        
        // Start timer
        taskCountdown = 15;
        document.getElementById('timerDisplay').style.display = 'block';
        document.getElementById('timerText').textContent = taskCountdown;
        
        activeTaskTimer = setInterval(() => {
            taskCountdown--;
            document.getElementById('timerText').textContent = taskCountdown;
            
            if (taskCountdown <= 0) {
                completeTask(taskId, round, roundKey);
                clearInterval(activeTaskTimer);
                document.getElementById('timerDisplay').style.display = 'none';
                
                showNotification(
                    currentLanguage === 'bn' ? 
                    `à¦Ÿà¦¾à¦¸à§à¦• à¦¸à¦®à§à¦ªà¦¨à§à¦¨ à¦¹à¦¯à¦¼à§‡à¦›à§‡! à¦°à¦¾à¦‰à¦¨à§à¦¡ ${round} à¦à¦° à¦œà¦¨à§à¦¯ à§§à§¦ à¦ªà¦¯à¦¼à§‡à¦¨à§à¦Ÿ à¦¯à§‹à¦— à¦•à¦°à¦¾ à¦¹à¦²à§‹` : 
                    `Task completed! 10 points added for Round ${round}`,
                    'success'
                );
            }
        }, 1000);
    }

    // Complete Task
    function completeTask(taskId, round, roundKey) {
        const now = new Date().toISOString();
        const today = new Date().toDateString();
        
        // Update task status
        db.ref(`userTasks/${currentUser.uid}/${roundKey}`).set({
            completed: true,
            lastCompleted: now,
            round: round,
            taskId: taskId
        }).then(() => {
            // Update user's daily count and points
            const newDailyCount = dailyTasks + 1;
            const newPoints = (userData.points || 0) + 10;
            const newTotalPoints = (userData.totalPoints || 0) + 10;
            
            // Check if this completes all 3 rounds for this task
            const round1Key = `${taskId}_round1`;
            const round2Key = `${taskId}_round2`;
            const round3Key = `${taskId}_round3`;
            
            const updateData = {
                dailyTaskCount: newDailyCount,
                lastTaskDate: today,
                points: newPoints,
                totalPoints: newTotalPoints
            };
            
            // If all 3 rounds completed for this task, increment tasksCompleted
            if (round === 3) {
                db.ref(`userTasks/${currentUser.uid}`).once('value')
                    .then(snapshot => {
                        const tasks = snapshot.val();
                        const round1Done = tasks[round1Key]?.completed;
                        const round2Done = tasks[round2Key]?.completed;
                        const round3Done = tasks[round3Key]?.completed;
                        
                        if (round1Done && round2Done && round3Done) {
                            updateData.tasksCompleted = (userData.tasksCompleted || 0) + 1;
                        }
                        
                        // Update user data
                        db.ref('users/' + currentUser.uid).update(updateData);
                    });
            } else {
                // Update user data
                db.ref('users/' + currentUser.uid).update(updateData);
            }
            
            // Reload tasks
            loadUserTaskStatus().then(() => {
                displayTasks('all');
                updateDailyProgress();
            });
        });
    }

    // Load Leaderboard
    function loadLeaderboard() {
        document.getElementById('leaderboardLoading').style.display = 'block';
        
        db.ref('users').orderByChild('totalPoints').limitToLast(20).once('value')
            .then(snapshot => {
                const users = snapshot.val();
                const container = document.getElementById('leaderboardList');
                container.innerHTML = '';
                
                if (users) {
                    const userArray = Object.entries(users).map(([id, user]) => ({ id, ...user }));
                    const sortedUsers = userArray.sort((a, b) => (b.totalPoints || 0) - (a.totalPoints || 0));
                    
                    let rank = 1;
                    sortedUsers.forEach(user => {
                        if (user.id === currentUser.uid) {
                            document.getElementById('statRank').textContent = '#' + rank;
                        }
                        
                        const leaderboardItem = document.createElement('div');
                        leaderboardItem.className = 'leaderboard-item';
                        if (user.id === currentUser.uid) {
                            leaderboardItem.style.background = 'rgba(233, 30, 99, 0.1)';
                        }
                        
                        const rankClass = rank <= 3 ? 'top-3' : '';
                        
                        leaderboardItem.innerHTML = `
                            <div class="leaderboard-rank ${rankClass}">${rank}</div>
                            <div class="leaderboard-user">
                                <strong>${user.name}</strong>
                                <div style="font-size: 0.8rem; color: var(--text-light);">
                                    ${user.type === 'couple' ? 
                                        (currentLanguage === 'bn' ? 'à¦•à¦¾à¦ªà¦²' : 'Couple') : 
                                        (currentLanguage === 'bn' ? 'à¦¸à¦¿à¦™à§à¦—à§‡à¦²' : 'Single')} â€¢ 
                                    ${user.invites || 0} ${currentLanguage === 'bn' ? 'à¦‡à¦¨à¦­à¦¾à¦‡à¦Ÿ' : 'Invites'}
                                </div>
                            </div>
                            <div class="leaderboard-points">${user.totalPoints || 0} ${currentLanguage === 'bn' ? 'à¦ªà¦¯à¦¼à§‡à¦¨à§à¦Ÿ' : 'Points'}</div>
                        `;
                        
                        container.appendChild(leaderboardItem);
                        rank++;
                    });
                    document.getElementById('leaderboardLoading').style.display = 'none';
                }
            });
    }

    // Copy Referral Link
    function copyReferralLink() {
        const link = document.getElementById('referralLink').textContent;
        const copyButton = document.getElementById('copyButton');
        
        navigator.clipboard.writeText(link).then(() => {
            // Change button to show copied
            copyButton.innerHTML = '<i class="fas fa-check"></i> <span class="lang-text" data-en="Copied!" data-bn="à¦•à¦ªà¦¿ à¦¹à¦¯à¦¼à§‡à¦›à§‡!"></span>';
            copyButton.classList.add('copied');
            
            showNotification(
                currentLanguage === 'bn' ? 'à¦°à§‡à¦«à¦¾à¦°à§‡à¦² à¦²à¦¿à¦‚à¦• à¦•à¦ªà¦¿ à¦•à¦°à¦¾ à¦¹à¦¯à¦¼à§‡à¦›à§‡!' : 'Referral link copied!',
                'success'
            );
            
            // Reset button after 2 seconds
            setTimeout(() => {
                copyButton.innerHTML = '<i class="fas fa-copy"></i> <span class="lang-text" data-en="Copy" data-bn="à¦•à¦ªà¦¿"></span>';
                copyButton.classList.remove('copied');
            }, 2000);
        }).catch(err => {
            showNotification(
                currentLanguage === 'bn' ? 'à¦•à¦ªà¦¿ à¦•à¦°à¦¾ à¦¯à¦¾à¦¯à¦¼à¦¨à¦¿!' : 'Failed to copy!',
                'error'
            );
        });
    }

    // Share on Facebook
    function shareOnFacebook() {
        const link = encodeURIComponent(document.getElementById('referralLink').textContent);
        const message = encodeURIComponent(document.getElementById('referralMessage').textContent);
        window.open(`https://www.facebook.com/sharer/sharer.php?u=${link}&quote=${message}`, '_blank');
    }

    // Share on WhatsApp
    function shareOnWhatsApp() {
        const link = document.getElementById('referralLink').textContent;
        const message = document.getElementById('referralMessage').textContent;
        const url = `https://wa.me/?text=${encodeURIComponent(message + '\n\n' + link)}`;
        window.open(url, '_blank');
    }

    // Save Payment Info
    function savePaymentInfo() {
        const paymentMethod = document.getElementById('paymentMethod').value;
        const paymentNumber = document.getElementById('paymentNumber').value.trim();
        const address = document.getElementById('userAddress').value.trim();
        
        if (!paymentMethod || !paymentNumber || !address) {
            Swal.fire({
                icon: 'error',
                title: currentLanguage === 'bn' ? 'à¦¤à§à¦°à§à¦Ÿà¦¿' : 'Error',
                text: currentLanguage === 'bn' ? 'à¦¸à¦®à¦¸à§à¦¤ à¦¤à¦¥à§à¦¯ à¦ªà§‚à¦°à¦£ à¦•à¦°à§à¦¨' : 'Please fill all information'
            });
            return;
        }
        
        db.ref('users/' + currentUser.uid).update({
            paymentMethod: paymentMethod,
            paymentNumber: paymentNumber,
            address: address
        }).then(() => {
            Swal.fire({
                icon: 'success',
                title: currentLanguage === 'bn' ? 'à¦¸à¦«à¦²!' : 'Success!',
                text: currentLanguage === 'bn' ? 'à¦ªà§‡à¦®à§‡à¦¨à§à¦Ÿ à¦¤à¦¥à§à¦¯ à¦¸à§‡à¦­ à¦•à¦°à¦¾ à¦¹à¦¯à¦¼à§‡à¦›à§‡' : 'Payment information saved successfully'
            });
        });
    }

    // Logout User
    function logoutUser() {
        auth.signOut().then(() => {
            window.location.reload();
        });
    }

    // Check URL for referral code
    function checkReferralCode() {
        const urlParams = new URLSearchParams(window.location.search);
        const refCode = urlParams.get('ref');
        
        if (refCode) {
            document.getElementById('regReferral').value = refCode;
        }
    }

    // Initialize on load
    window.onload = function() {
        // Set up language toggle
        document.getElementById('languageToggle').addEventListener('click', toggleLanguage);
        
        // Initialize language
        updateLanguage();
        
        checkReferralCode();
        
        // Check if user is already logged in
        auth.onAuthStateChanged(user => {
            if (user) {
                loadDashboard();
            }
        });
    };
</script>
</body>
</html>